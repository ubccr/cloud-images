{
  "variables": {
    "image_type": "{{env `PACKER_IMAGE_TYPE`}}",
    "provision_passwd": ""
  },
  "builders": [
  {
  "name": "centos7",
  "type": "qemu",
  "format": "raw",
  "iso_url": "http://mirrors.cbls.ccr.buffalo.edu/centos/latest/7.5.1804/isos/x86_64/CentOS-7-x86_64-NetInstall-1804.iso",
  "iso_checksum": "937bf0a7b0932817f84f7230f15ed88911bbbd85c0c958680792b7f8d8f9c1a9",
  "iso_checksum_type": "sha256",
  "ssh_username": "root",
  "ssh_password": "{{user `provision_passwd`}}",
  "disk_size": "10000",
  "http_directory" : ".",
  "http_port_min" : 9002,
  "http_port_max" : 9002,
  "shutdown_command": "shutdown -P now",
  "vm_name": "CHANGE_NAME",
  "output_directory": "CHANGE_NAME",
  "disk_interface": "virtio",
  "ssh_wait_timeout": "3000000s",
  "qemu_binary": "/usr/libexec/qemu-kvm",
  "headless": true,
  "accelerator": "kvm",
  "qemuargs": [[ "-m", "1024m" ],
               ["-machine", "type=pc,accel=kvm"],
               ["-device", "virtio-net-pci,netdev=user.0"]],
  "boot_command" : ["<tab> text ks=http://{{ .HTTPIP }}:{{ .HTTPPort }}/centos-7.ks<enter><wait>"]  
  }
  ],
  "provisioners": [
    {
      "type": "file",
      "source": "deploy",
      "destination": "/tmp"
    },
    {
      "type": "shell",
      "environment_vars": [ "IMAGE_TYPE={{user `image_type`}}" ],
      "script": "post_install.sh"
    }
  ]
}
