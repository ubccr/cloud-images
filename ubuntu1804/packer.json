{
  "variables": {
    "provision_passwd": ""
  },
  "builders": [{
    "name": "ubuntu1804",
    "type": "qemu",
    "format": "raw",
    "iso_url": "http://mirrors.cbls.ccr.buffalo.edu/isos/ubuntu-18.04.1-server-amd64.iso",
    "iso_checksum": "a5b0ea5918f850124f3d72ef4b85bda82f0fcd02ec721be19c1a6952791c8ee8",
    "iso_checksum_type": "sha256",
    "output_directory": "CHANGE_NAME",
    "vm_name": "CHANGE_NAME",
    "disk_size": "10000",
    "headless": "true",
    "http_directory" : ".",
    "http_port_min" : 9007,
    "http_port_max" : 9007,
    "boot_wait": "10s",
    "boot_command": [
      "<esc><wait>",
      "<esc><wait>",
      "<enter><wait>",
      "/install/vmlinuz ",
      "initrd=/install/initrd.gz ",
      "auto-install/enable=true ",
      "debian-installer=en_US auto locale=en_US kbd-chooser/method=us ",
      "keyboard-configuration/modelcode=SKIP keyboard-configuration/layout=USA ",
      "keyboard-configuration/variant=USA console-setup/ask_detect=false ",
      "debconf/priority=critical ",
      "preseed/url=http://{{.HTTPIP}}:{{.HTTPPort}}/preseed.cfg<wait>",
      " -- <wait>",
      "<enter><wait>"
    ],
    "ssh_wait_timeout": "60m",
    "ssh_username": "root",
    "ssh_password": "{{user `provision_passwd`}}",
    "shutdown_command": "sudo systemctl poweroff",
    "disk_interface": "virtio",
    "qemu_binary": "/usr/libexec/qemu-kvm",
    "disk_interface": "virtio",
    "headless": true,
    "accelerator": "kvm",
    "qemuargs": [["-machine", "type=pc,accel=kvm"],
                 ["-device", "virtio-net-pci,netdev=user.0"]]
  }
],
  "provisioners": [
    {
      "type": "file",
      "source": "deploy",
      "destination": "/tmp"
    },
  {
    "type": "shell",
    "script": "post_install.sh"
  }]
}
